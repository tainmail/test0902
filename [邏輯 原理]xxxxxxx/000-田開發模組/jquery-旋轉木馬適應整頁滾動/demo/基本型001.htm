<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>jquery-旋轉木馬適應整頁滾動</title>
<script type="text/javascript" src="jquery.js"></script>
<style>

</style>

<style>
*{ margin:0px; padding:0px;}
a img { border: none; }


/*slidePage 設定======================================*/
body{ overflow-x:hidden;/*必要*/} 
/*圖集*/
.gallery_1 {width:1000px; margin:0 auto; height:500px; position: relative;}
/*外容器*/
.gallery_1 .run {width:1000px; margin:0 auto; height:500px; position:relative;}
/*內容器*/
.gallery_1 .run .runinner {/*width:由程式定義*/ height:500px; float:left; position:relative;}
/*單組*/
.gallery_1 .run .runinner .piece {width:1000px; height:500px; position:relative; float:left; }

/*上下頁按鈕*/
.gallery_1 a.prev { display:block; width:100%; height:500px; background:url(btn_prev.jpg) no-repeat right top; position:absolute; top:0px; right:1000px; opacity:0.7;  }
.gallery_1 a.next { display:block; width:100%; height:500px; background:url(btn_next.jpg) no-repeat left top;  position:absolute; top:0px; left:1000px;  opacity:0.7;  }
.gallery_1 a.prev span, .gallery_1 a.next span{ display:none;}


</style>

<script type="text/javascript">
$(function(){
	var $slidePage = $('.gallery_1'),               //圖集組 
	$run = $slidePage.find('.run'),                 //外容器
	$runInner = $run.find('.runinner'),             //內容器
	$piece = $runInner.find(".piece"),              //圖集組
	
	iRunWidth = $run.width(),                       //圖集的寬
	iPieceAmount = $piece.length,                   //圖集組數
	iRunInnerWidth = ($run.width()) * iPieceAmount, //內容器總寬 
	iRunLeft = iRunWidth * -1,                      //向左移的距離 
	iRunSpeed = 400,                                //左移的速度
	iTimer,               // 加入計時器
	iShowDuration = 2000, //輪播時間及
	bStop = false         //控制開關

	
	//初始化
	$runInner.width(iRunInnerWidth)
		.find('.piece:first')
		.before($runInner.find('.piece:last')) // 先把最後一個 .piece 的內容插入到第一個 .piece 前面
		.end()
		.css({
			//width: iRunWidth * ($runInner.find('.piece') + 1), // 並設定 $runInner 的 left 及 width
			left: iRunLeft
		}
	);

	// 當點擊到 a.prev 時
	var $prev = $slidePage.find('a.prev')
				.click(function(){
					// 移動 $runInner
					$runInner.stop(false, true).animate({'left' : iRunLeft + iRunWidth}, iRunSpeed, function () {
						// 把最後一個 .piece 的內容插入到第一個 .piece 前面
						$runInner.find('.piece:first').before($runInner.find('.piece:last')).end().css('left', iRunLeft);
						// 當移動到正確位置後, 依判斷來啟動計時器
						if(!bStop) {
							clearTimeout(iTimer);
							iTimer = setTimeout(fnMove, iShowDuration);
						}
					});
					return false;
				});

	// 當點擊到 a.next 時
	var $next = $slidePage.find('a.next')
				.click(function(){
					// 移動 $runInner
					$runInner.stop(false, true).animate({'left' : iRunLeft - iRunWidth}, iRunSpeed, function () {
						// 把第一個 .piece 的內容插入到最後一個 .piece 後面
						$runInner.find('.piece:last').after($runInner.find('.piece:first')).end().css('left', iRunLeft);
						// 當移動到正確位置後, 依判斷來啟動計時器
						if(!bStop) {
							clearTimeout(iTimer);
							iTimer = setTimeout(fnMove, iShowDuration);
						}
					});
					return false;
				});

	// 如果滑鼠移入 $slidePage 時
	$slidePage.hover(
		function(){
			bStop = true;// 關閉開關及計時器
			clearTimeout(iTimer);
		}, 
		function(){
			bStop = false; // 開啟開關及計時器
			iTimer = setTimeout(fnMove, iShowDuration);
		})
		.find('a').focus(function(){
			this.blur();
		});

	// 計時器使用
	function fnMove(){
		$next.click();
	};
	
	iTimer = setTimeout(fnMove, iShowDuration);

});

</script> 

</head>
<body>
<div class="header" style=" width:1000px; margin:0 auto; height:100px; background:#777;"><h1>jquery-旋轉木馬適應整頁滾動</h1>
</div>
<!--大圖輪播開始-->
    <div class="gallery_1">
        <div class="run">
            <div class="runinner">
                <div class="piece"><a href="#"><img src="pic/pic001.jpg"/></a></div>
                <div class="piece"><a href="#"><img src="pic/pic002.jpg"/></a></div>
                <div class="piece"><a href="#"><img src="pic/pic003.jpg"/></a></div>
                <div class="piece"><a href="#"><img src="pic/pic004.jpg"/></a></div>
                <div class="piece"><div class="box_1" style=" width:300px; height:200px; background:#99CC33;">這是非圖像內容</div></div>
                <div class="piece"><a href="#"><img src="pic/pic005.jpg"/></a></div>
            </div>
        </div>
    
    <a href="#" class="prev"><span>上一頁</span></a>
    <a href="#" class="next"><span>下一頁</span></a>
    </div>
<!--大圖輪播結束-->
<div class="footer" style=" width:1000px; margin:0 auto; height:100px; background:#333;"><h1>footer</h1></div>

</body>
</html>
