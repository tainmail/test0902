<!DOCTYPE HTML>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/jquery.touchSwipe.js"></script>
<title>touchSwipe</title>

<style>
#gallery_1 { height:300px; width:300px; overflow:hidden; position:relative; border :5px solid red; }

#run { float:left; display:inline; 
-webkit-transition-property: -webkit-transform; 
-webkit-transition-duration: 0.5s; 
-webkit-transition-timing-function: ease-out; 
padding:0px; margin:0px; width:1800px; 
/*apply a transfor to kick in the hardware acceleration.  Without this, the first time we add the transform you get odd rendering of the divs (half missing) */
-webkit-transform: translate3d(0px, 0px, 0px);
}

#run .piece { padding:0px; margin:0px; width:300px; height:300px; float:left;
background:#999933;
/*apply a transfor to kick in the hardware acceleration.  Without this, the first time we add the transform you get odd rendering of the divs (half missing) */
-webkit-transform: translate3d(0px, 0px, 0px);
}

</style>
</head>
<body>
<div id="gallery_1">
    <div id="run">
    
    <div class="piece"><img src="images/pic_1.jpg" width="300"></div>
    <div class="piece"><img src="images/pic_2.jpg" width="300"></div>
    <div class="piece"><img src="images/pic_3.jpg" width="300"></div>
    <div class="piece">4444像內容這是非圖像內容這是非圖像內容</div>
    <div class="piece"><img src="images/pic_5.jpg" width="300"></div>
    </div>
</div>
</body>
<script>
var iGalleryW = 300;
var iCurrent=0;
var iAmount=5;
var iSpeed=300;
		
var $run;
			
var swipeOptions={
		triggerOnTouchEnd : true,	
		swipeStatus : fnStatus,
		allowPageScroll:"vertical",
		threshold:30			
};
		
$(function(){				
	$run = $("#run");
	$run.swipe( swipeOptions );
});
		
/**
* Catch each phase of the swipe.
* move : we drag the div.  移動內容器
* cancel : we animate back to where we were 移動不足回到原來的位置
* end : we animate to the next image   成功觸發，移到該位罝
*/			

function fnStatus(event, phase, direction, distance){
	//If we are moving before swipe, and we are going Lor R in X mode, or U or D in Y mode then drag.
	if( phase=="move" && (direction=="left" || direction=="right") ){
		var duration=0; //按壓移動時，不作動畫
		if (direction == "left"){
			fnScrollPiece((iGalleryW * iCurrent) + distance, duration);
		}else if (direction == "right"){
			fnScrollPiece((iGalleryW * iCurrent) - distance, duration);
		};
	}else if ( phase == "cancel"){
		fnScrollPiece(iGalleryW * iCurrent, iSpeed);
	}else if ( phase =="end" ){
		if (direction == "right"){
			fnPrev();
		}else if (direction == "left"){
			fnNext()
		};			
	};
};
					
function fnPrev(){
	iCurrent = Math.max(iCurrent-1, 0); //如果第0個，就當0
	fnScrollPiece( iGalleryW * iCurrent, iSpeed);
};
		
function fnNext(){
	iCurrent = Math.min(iCurrent+1, iAmount-1); //如果最末序，就當最未序
	fnScrollPiece( iGalleryW * iCurrent, iSpeed);
};
				
/**
* Manuallt update the position of the "run" on drag
*/
function fnScrollPiece(distance, duration){
	//動畫時間。
	$run.css("-webkit-transition-duration", (duration/1000).toFixed(1) + "s");
	//inverse the number we set in the css
	var iPosX = (distance<0 ? "" : "-") + Math.abs(distance).toString();
	$run.css("-webkit-transform", "translate3d("+iPosX +"px,0px,0px)");
};
		</script>
</html>